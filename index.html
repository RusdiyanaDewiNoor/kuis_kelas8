<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Petualangan Labirin Komputasi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Poppins', system-ui, -apple-system, sans-serif;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }
    
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.1);
      }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .slide-in {
      animation: slideIn 0.5s ease-out;
    }
    
    .bounce-animation {
      animation: bounce 2s ease-in-out infinite;
    }
    
    .pulse-animation {
      animation: pulse 0.5s ease-in-out;
    }
    
    .shake-animation {
      animation: shake 0.5s ease-in-out;
    }
    
    .checkpoint-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .checkpoint-icon:hover {
      transform: scale(1.1);
    }
    
    .checkpoint-completed {
      opacity: 0.6;
      cursor: default;
    }
    
    .checkpoint-active {
      animation: pulse 1.5s ease-in-out infinite;
    }
    
    .checkpoint-locked {
      opacity: 0.3;
      cursor: not-allowed;
    }
    
    .maze-path {
      stroke-dasharray: 10, 5;
      animation: dash 20s linear infinite;
    }
    
    @keyframes dash {
      to {
        stroke-dashoffset: -100;
      }
    }
    
    .stack-item {
      transition: all 0.3s ease;
    }
    
    .draggable-item {
      cursor: move;
      user-select: none;
    }
    
    .drop-zone {
      min-height: 60px;
      transition: all 0.2s ease;
    }
    
    .drop-zone.drag-over {
      transform: scale(1.02);
      border-width: 3px;
    }
    
    .feedback-correct {
      background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      border: 3px solid #10b981;
    }
    
    .feedback-incorrect {
      background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
      border: 3px solid #ef4444;
    }
    
    .virtual-keyboard {
      display: grid;
      gap: 4px;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .keyboard-row {
      display: flex;
      gap: 4px;
      justify-content: center;
    }
    
    .key-button {
      min-width: 32px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      user-select: none;
    }
    
    .key-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.15);
    }
    
    .key-button:active {
      transform: translateY(0);
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    .key-space {
      min-width: 200px;
    }
    
    .key-special {
      min-width: 50px;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="w-full h-full"></div>
  <script>
    // Configuration
    const defaultConfig = {
      quiz_title: "Petualangan Berpikir Komputasi",
      maze_theme: "Perjalanan dari Kelas ke Perpustakaan",
      primary_color: "#6366f1",
      secondary_color: "#ffffff",
      text_color: "#1f2937",
      accent_color: "#10b981",
      background_color: "#ede9fe",
      font_family: "Poppins",
      font_size: 16
    };

    // Game state
    let studentName = "";
    let currentCheckpoint = 0;
    let completedCheckpoints = [];
    let currentScreen = "welcome"; // welcome, maze, question, feedback, victory
    let currentAttempts = 0;
    let userAnswer = "";
    let draggedElement = null;
    let stackItems = [];

    // Checkpoint data with MULTIPLE VARIATIONS - each student gets different questions
    const checkpointVariations = [
      // Checkpoint 1: Fungsi Linear (3 variations)
      [
        {
          id: 1,
          icon: "üå±",
          topic: "Fungsi Linear",
          title: "Pola Pertumbuhan Tanaman",
          description: "Seorang petani mengamati pertumbuhan tinggi tanaman tomat setiap minggu:",
          data: {
            table: [
              { week: 1, height: 5 },
              { week: 2, height: 9 },
              { week: 3, height: 13 },
              { week: 4, height: 17 },
              { week: 5, height: "?" }
            ]
          },
          question: "Berdasarkan data pengamatan di atas, tentukan rumus fungsi linear yang tepat untuk menghitung tinggi tanaman (T) pada minggu ke-n!",
          type: "multiple_choice",
          options: [
            "T = 4n + 1",
            "T = 5n + 4",
            "T = 3n + 2",
            "T = 2n + 7"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: T = 4n + 1\n\nLangkah-Langkah Berpikir Komputasional:\n1) Identifikasi Data: Perhatikan pasangan (minggu, tinggi): (1,5), (2,9), (3,13), (4,17)\n2) Cari Pola Selisih: Hitung selisih tinggi antar minggu:\n   - Minggu 2-1: 9-5 = 4 cm\n   - Minggu 3-2: 13-9 = 4 cm\n   - Minggu 4-3: 17-13 = 4 cm\n3) Temukan Keteraturan: Selisih tetap 4 cm (ini adalah koefisien n)\n4) Tentukan Nilai Awal: Saat n=1, tinggi=5. Masukkan ke rumus: 5 = 4(1) + c ‚Üí c = 1\n5) Susun Rumus: T = 4n + 1\n6) Uji Rumus: T(1)=5‚úì, T(2)=9‚úì, T(3)=13‚úì, T(4)=17‚úì, T(5)=21\n\nKomputer memahami pola dengan mencari keteraturan dalam data!"
        },
        {
          id: 1,
          icon: "üå±",
          topic: "Fungsi Linear",
          title: "Pola Pertumbuhan Tanaman Jagung",
          description: "Seorang petani mengamati pertumbuhan tinggi tanaman jagung setiap minggu:",
          data: {
            table: [
              { week: 1, height: 8 },
              { week: 2, height: 13 },
              { week: 3, height: 18 },
              { week: 4, height: 23 },
              { week: 5, height: "?" }
            ]
          },
          question: "Berdasarkan data pengamatan di atas, tentukan rumus fungsi linear yang tepat untuk menghitung tinggi tanaman jagung (T) pada minggu ke-n!",
          type: "multiple_choice",
          options: [
            "T = 5n + 3",
            "T = 3n + 5",
            "T = 4n + 4",
            "T = 6n + 2"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: T = 5n + 3\n\nLangkah-Langkah Berpikir Komputasional:\n1) Identifikasi Data: Perhatikan pasangan (minggu, tinggi): (1,8), (2,13), (3,18), (4,23)\n2) Cari Pola Selisih: Hitung selisih tinggi antar minggu:\n   - Minggu 2-1: 13-8 = 5 cm\n   - Minggu 3-2: 18-13 = 5 cm\n   - Minggu 4-3: 23-18 = 5 cm\n3) Temukan Keteraturan: Selisih tetap 5 cm (ini adalah koefisien n)\n4) Tentukan Nilai Awal: Saat n=1, tinggi=8. Masukkan ke rumus: 8 = 5(1) + c\n   8 = 5 + c\n   c = 3\n5) Susun Rumus: T = 5n + 3\n6) Uji Rumus: T(1)=8‚úì, T(2)=13‚úì, T(3)=18‚úì, T(4)=23‚úì, T(5)=28\n\nKomputer memahami pola dengan mencari keteraturan dalam data!"
        },
        {
          id: 1,
          icon: "üå±",
          topic: "Fungsi Linear",
          title: "Pola Pertumbuhan Tanaman Kacang",
          description: "Seorang petani mengamati pertumbuhan tinggi tanaman kacang setiap minggu:",
          data: {
            table: [
              { week: 1, height: 6 },
              { week: 2, height: 9 },
              { week: 3, height: 12 },
              { week: 4, height: 15 },
              { week: 5, height: "?" }
            ]
          },
          question: "Berdasarkan data pengamatan di atas, tentukan rumus fungsi linear yang tepat untuk menghitung tinggi tanaman kacang (T) pada minggu ke-n!",
          type: "multiple_choice",
          options: [
            "T = 3n + 3",
            "T = 4n + 2",
            "T = 2n + 4",
            "T = 5n + 1"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: T = 3n + 3\n\nLangkah-Langkah Berpikir Komputasional:\n1) Identifikasi Data: Perhatikan pasangan (minggu, tinggi): (1,6), (2,9), (3,12), (4,15)\n2) Cari Pola Selisih: Hitung selisih tinggi antarminggu:\n   - Minggu 2-1: 9-6 = 3 cm\n   - Minggu 3-2: 12-9 = 3 cm\n   - Minggu 4-3: 15-12 = 3 cm\n3) Temukan Keteraturan: Selisih tetap 3 cm (ini adalah koefisien n)\n4) Tentukan Nilai Awal: Saat n=1, tinggi=6. Masukkan ke rumus: 6 = 3(1) + c\n   6 = 3 + c\n   c = 3\n5) Susun Rumus: T = 3n + 3\n6) Uji Rumus: T(1)=6‚úì, T(2)=9‚úì, T(3)=12‚úì, T(4)=15‚úì, T(5)=18\n\nKomputer memahami pola dengan mencari keteraturan dalam data!"
        }
      ],
      // Checkpoint 2: Himpunan (3 variations)
      [
        {
          id: 2,
          icon: "üå∫",
          topic: "Himpunan",
          title: "Teka-Teki Pupuk Pak Budi",
          description: "Pak Budi memiliki 5 jenis pupuk ajaib dan 1 gelas berisi air biasa (total: 6 botol, A sampai F). Setiap pupuk memiliki efek unik:",
          data: {
            effects: [
              "üå∏ Pupuk Merah: Membuat kelopak berlapis ganda",
              "üçÉ Pupuk Hijau: Menumbuhkan daun lebat",
              "üåä Pupuk Biru: Tangkai bergelombang",
              "‚ö™ Pupuk Putih: Kelopak berubah putih",
              "‚ö´ Pupuk Hitam: Bagian tengah bunga menjadi hitam"
            ],
            initial: "Bunga awal: kelopak tunggal merah, daun sedikit, tangkai lurus",
            experiments: [
              { mix: "A + B + C", result: "Kelopak berlapis + daun lebat + tangkai bergelombang" },
              { mix: "A + D + E", result: "Kelopak berlapis + kelopak putih + bagian tengah hitam" },
              { mix: "C + D + F", result: "Tangkai bergelombang + kelopak putih" }
            ]
          },
          question: "Berdasarkan analisis percobaan di atas, gelas manakah yang berisi air biasa (tidak memiliki efek apa pun)?",
          type: "multiple_choice",
          options: [
            "Gelas A",
            "Gelas B",
            "Gelas D",
            "Gelas F"
          ],
          correctAnswer: 3,
          explanation: "Jawaban yang benar: Gelas F berisi air\n\nBerikut Uraiannya:\n\n1) Percobaan 1 (A+B+C): Menghasilkan 3 efek berbeda\n   ‚Üí Ketiga gelas (A, B, C) pasti berisi pupuk\n\n2) Percobaan 2 (A+D+E): Menghasilkan 3 efek berbeda\n   ‚Üí A sudah pasti pupuk (dari percobaan 1)\n   ‚Üí D dan E pasti pupuk juga\n\n3) Percobaan 3 (C+D+F): Hanya menghasilkan 2 efek\n   ‚Üí C dan D sudah pasti pupuk\n   ‚Üí Seharusnya ada 3 efek, tetapi hanya 2\n   ‚Üí F tidak memberikan efek ‚Üí F berisi air!\n\n4) Pencocokan Efek:\n   - A = Pupuk Merah (kelopak berlapis)\n   - B = Pupuk Hijau (daun lebat)\n   - C = Pupuk Biru (tangkai bergelombang)\n   - D = Pupuk Putih (kelopak putih)\n   - E = Pupuk Hitam (bagian tengah hitam)\n   - F = Air (tidak ada efek)\n\nMetode: Eliminasi berdasarkan data percobaan (teknik penyelesaian masalah dalam berpikir komputasional)"
        },
        {
          id: 2,
          icon: "üå∫",
          topic: "Himpunan",
          title: "Teka-Teki Pewarna Bu Ani",
          description: "Bu Ani memiliki 5 jenis pewarna kue dan 1 botol berisi air biasa (total: 6 botol yaitu P sampai U). Setiap pewarna memiliki efek yang berbeda-beda:",
          data: {
            effects: [
              "Pewarna Merah: Warna kue menjadi merah cerah",
              "Pewarna Kuning: Warna kue menjadi kuning terang",
              "Pewarna Hijau: Kue beraroma pandan",
              "Pewarna Biru: Warna kue menjadi biru laut",
              "Pewarna Ungu: Tekstur kue lembut"
            ],
            initial: "Kue awal: putih polos, tekstur biasa, tanpa aroma",
            experiments: [
              { mix: "P + Q + R", result: "Merah cerah + kuning terang + aroma pandan" },
              { mix: "P + S + T", result: "Merah cerah + biru laut + tekstur lembut" },
              { mix: "Q + T + U", result: "Kuning terang + tekstur lembut" }
            ]
          },
          question: "Berdasarkan analisis percobaan di atas, botol manakah yang berisi air biasa (tidak memiliki efek apa pun)?",
          type: "multiple_choice",
          options: [
            "Botol P",
            "Botol Q",
            "Botol R",
            "Botol U"
          ],
          correctAnswer: 3,
          explanation: "Jawaban yang benar: Botol U berisi air\n\nBerikut Uraiannya:\n\n1) Percobaan 1 (P+Q+R): Menghasilkan 3 efek berbeda\n   ‚Üí Ketiga botol (P, Q, R) pasti berisi pewarna\n\n2) Percobaan 2 (P+S+T): Menghasilkan 3 efek berbeda\n   ‚Üí P sudah pasti pewarna (dari percobaan 1)\n   ‚Üí S dan T pasti pewarna juga\n\n3) Percobaan 3 (Q+T+U): Hanya menghasilkan 2 efek\n   ‚Üí Q dan T sudah pasti pewarna\n   ‚Üí Seharusnya ada 3 efek, tetapi hanya 2\n   ‚Üí U tidak memberikan efek ‚Üí U berisi air!\n\n4) Pencocokan Efek:\n   - P = Pewarna Merah (merah cerah)\n   - Q = Pewarna Kuning (kuning terang)\n   - R = Pewarna Hijau (aroma pandan)\n   - S = Pewarna Biru (biru laut)\n   - T = Pewarna Ungu (tekstur lembut)\n   - U = Air (tidak ada efek)\n\nMetode: Eliminasi berdasarkan data percobaan"
        },
        {
          id: 2,
          icon: "üå∫",
          topic: "Himpunan",
          title: "Teka-Teki Vitamin Pak Andi",
          description: "Pak Andi memiliki 5 jenis vitamin tanaman dan 1 botol berisi air biasa (total: 6 botol U sampai Z). Setiap vitamin memiliki efek unik:",
          data: {
            effects: [
              "üåü Vitamin A: Daun lebih mengkilap",
              "üí™ Vitamin B: Batang lebih kuat",
              "üåø Vitamin C: Akar tumbuh panjang",
              "üå∏ Vitamin D: Bunga lebih banyak",
              "üçÉ Vitamin E: Daun lebih hijau"
            ],
            initial: "Tanaman awal: daun kusam, batang lemah, akar pendek",
            experiments: [
              { mix: "U + V + W", result: "Daun mengkilap + batang kuat + akar panjang" },
              { mix: "U + X + Y", result: "Daun mengkilap + bunga banyak + daun hijau" },
              { mix: "V + Y + Z", result: "Batang kuat + daun hijau" }
            ]
          },
          question: "Berdasarkan analisis percobaan di atas, botol manakah yang berisi air biasa (tidak memiliki efek apa pun)?",
          type: "multiple_choice",
          options: [
            "Botol V",
            "Botol W",
            "Botol Y",
            "Botol Z"
          ],
          correctAnswer: 3,
          explanation: "Jawaban yang benar: Botol Z berisi air\n\nBerikut Uraiannya:\n\n1) Percobaan 1 (U+V+W): Menghasilkan 3 efek berbeda\n   ‚Üí Ketiga botol (U, V, W) pasti berisi vitamin\n\n2) Percobaan 2 (U+X+Y): Menghasilkan 3 efek berbeda\n   ‚Üí u sudah pasti vitamin (dari percobaan 1)\n   ‚Üí X dan Y pasti vitamin juga\n\n3) Percobaan 3 (V+Y+Z): Hanya menghasilkan 2 efek\n   ‚Üí V dan Y sudah pasti vitamin\n   ‚Üí Seharusnya ada 3 efek, tetapi hanya 2\n   ‚Üí Z tidak memberikan efek ‚Üí Z berisi air!\n\n4) Pencocokan Efek:\n   - Y = Vitamin A (daun mengkilap)\n   - V = Vitamin B (batang kuat)\n   - W = Vitamin C (akar panjang)\n   - X = Vitamin D (bunga banyak)\n   - Y = Vitamin E (daun hijau)\n   - Z = Air (tidak ada efek)\n\nMetode: Eliminasi berdasarkan data percobaan"
        }
      ],
      // Checkpoint 3: Konversi Desimal ke Biner (3 variations)
      [
        {
          id: 3,
          icon: "üî¢",
          topic: "Konversi Desimal ke Biner",
          title: "Kode Rahasia Loker",
          description: "Loker di perpustakaan menggunakan sistem kode biner. Kamu menemukan petunjuk kode loker dalam desimal: 156",
          data: {
            clue: "Kode loker dalam desimal: 156",
            hint: "Untuk membuka loker, kode harus diubah ke sistem biner (basis 2)",
            process: "Komputer mengubah angka desimal ke bahasa mesin (0 dan 1) melalui pembagian berulang"
          },
          question: "Berapakah hasil konversi bilangan desimal 156 ke dalam sistem bilangan biner?",
          type: "multiple_choice",
          options: [
            "10011100",
            "10011010",
            "10101100",
            "11001100"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: 10011100‚ÇÇ\n\nAlgoritma Konversi Desimal Ke Biner:\n\n1) Bagi bilangan dengan 2\n2) Catat hasil bagi dan sisa pembagian\n3) Ulangi langkah 1-2 dengan hasil bagi sampai hasil bagi = 0\n4) Baca sisa pembagian dari bawah ke atas\n\n Berikut proses konversi 156‚ÇÅ‚ÇÄ:\n156 √∑ 2 = 78 sisa 0 ‚Üê\n78 √∑ 2 = 39 sisa 0 ‚Üê\n39 √∑ 2 = 19 sisa 1 ‚Üê\n19 √∑ 2 = 9 sisa 1 ‚Üê\n9 √∑ 2 = 4 sisa 1 ‚Üê\n4 √∑ 2 = 2 sisa 0 ‚Üê\n2 √∑ 2 = 1 sisa 0 ‚Üê\n1 √∑ 2 = 0 sisa 1 ‚Üê (berhenti)\n\nBaca dari bawah ke atas: 1-0-0-1-1-1-0-0\n\nHasilnya: 156‚ÇÅ‚ÇÄ = 10011100‚ÇÇ\n\nUraian:\n1√ó128 + 0√ó64 + 0√ó32 + 1√ó16 + 1√ó8 + 1√ó4 + 0√ó2 + 0√ó1\n= 128 + 16 + 8 + 4 = 156 ‚úì\n\nInilah cara komputer menyimpan angka dalam memori!"
        },
        {
          id: 3,
          icon: "üî¢",
          topic: "Konversi Desimal ke Biner",
          title: "Kode Brankas Digital",
          description: "Brankas digital di lab komputer menggunakan sistem kode biner. Kamu menemukan petunjuk kode brankas dalam desimal: 203",
          data: {
            clue: "Kode brankas dalam desimal: 203",
            hint: "Untuk membuka brankas, kode harus diubah ke sistem biner (basis 2)",
            process: "Komputer mengubah angka desimal ke bahasa mesin (0 dan 1) melalui pembagian berulang"
          },
          question: "Berapakah hasil konversi bilangan desimal 203 ke dalam sistem bilangan biner?",
          type: "multiple_choice",
          options: [
            "11001011",
            "11010011",
            "10110011",
            "11001101"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: 11001011‚ÇÇ\n\nAlgoritma Konversi Desimal Ke Biner:\n\n1) Bagi bilangan dengan 2\n2) Catat hasil bagi dan sisa pembagian\n3) Ulangi langkah 1-2 dengan hasil bagi sampai hasil bagi = 0\n4) Baca sisa pembagian dari bawah ke atas\n\n Berikut proses konversi 203‚ÇÅ‚ÇÄ:\n203 √∑ 2 = 101 sisa 1 ‚Üê\n101 √∑ 2 = 50 sisa 1 ‚Üê\n50 √∑ 2 = 25 sisa 0 ‚Üê\n25 √∑ 2 = 12 sisa 1 ‚Üê\n12 √∑ 2 = 6 sisa 0 ‚Üê\n6 √∑ 2 = 3 sisa 0 ‚Üê\n3 √∑ 2 = 1 sisa 1 ‚Üê\n1 √∑ 2 = 0 sisa 1 ‚Üê (berhenti)\n\nBaca dari bawah ke atas: 1-1-0-0-1-0-1-1\n\nHasilnya: 203‚ÇÅ‚ÇÄ = 11001011‚ÇÇ\n\nUraian:\n1√ó128 + 1√ó64 + 0√ó32 + 0√ó16 + 1√ó8 + 0√ó4 + 1√ó2 + 1√ó1\n= 128 + 64 + 8 + 2 + 1 = 203 ‚úì"
        },
        {
          id: 3,
          icon: "üî¢",
          topic: "Konversi Desimal ke Biner",
          title: "Kode Pintu Laboratorium",
          description: "Pintu laboratorium robotika menggunakan sistem kode biner. Kamu menemukan petunjuk kode pintu dalam desimal: 178",
          data: {
            clue: "Kode pintu laboratorium dalam desimal: 178",
            hint: "Untuk membuka pintu, kode harus diubah ke sistem biner (basis 2)",
            process: "Komputer mengubah angka desimal ke bahasa mesin (0 dan 1) melalui pembagian berulang"
          },
          question: "Berapakah hasil konversi bilangan desimal 178 ke dalam sistem bilangan biner?",
          type: "multiple_choice",
          options: [
            "10110010",
            "10101110",
            "11010010",
            "10111010"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: 10110010‚ÇÇ\n\nAlgoritma Konversi Desimal Ke Biner:\n\n1) Bagi bilangan dengan 2\n2) Catat hasil bagi dan sisa pembagian\n3) Ulangi langkah 1-2 dengan hasil bagi sampai hasil bagi = 0\n4) Baca sisa pembagian dari bawah ke atas\n\nBerikut proses konversi 178‚ÇÅ‚ÇÄ:\n178 √∑ 2 = 89 sisa 0 ‚Üê\n89 √∑ 2 = 44 sisa 1 ‚Üê\n44 √∑ 2 = 22 sisa 0 ‚Üê\n22 √∑ 2 = 11 sisa 0 ‚Üê\n11 √∑ 2 = 5 sisa 1 ‚Üê\n5 √∑ 2 = 2 sisa 1 ‚Üê\n2 √∑ 2 = 1 sisa 0 ‚Üê\n1 √∑ 2 = 0 sisa 1 ‚Üê (berhenti)\n\nBaca dari bawah ke atas: 1-0-1-1-0-0-1-0\n\nHasilnya: 178‚ÇÅ‚ÇÄ = 10110010‚ÇÇ\n\nUraian:\n1√ó128 + 0√ó64 + 1√ó32 + 1√ó16 + 0√ó8 + 0√ó4 + 1√ó2 + 0√ó1\n= 128 + 32 + 16 + 2 = 178 ‚úì"
        }
      ],
      // Checkpoint 4: Konversi Biner ke Desimal (3 variations)
      [
        {
          id: 4,
          icon: "üíæ",
          topic: "Konversi Biner ke Desimal",
          title: "Pesan Tersembunyi",
          description: "Kamu menemukan pesan dalam kode biner di komputer lama perpustakaan:",
          data: {
            message: "Kode Biner: 1011010",
            mission: "Dekripsi kode ini ke angka desimal untuk menemukan nomor rak buku",
            hint: "Setiap posisi digit biner memiliki nilai tempat berupa pangkat 2"
          },
          question: "Berapakah hasil konversi bilangan biner 1011010 ke dalam sistem bilangan desimal?",
          type: "multiple_choice",
          options: [
            "88",
            "90",
            "92",
            "94"
          ],
          correctAnswer: 1,
          explanation: "Jawaban yang benar: 90‚ÇÅ‚ÇÄ\n\nProses Konversi Biner Ke Desimal:\n\n1) Tulis posisi bit dari kanan ke kiri (dimulai dari 0)\n2) Hitung nilai tempat setiap posisi: 2‚Å∞, 2¬π, 2¬≤, 2¬≥, ...\n3) Kalikan setiap digit biner dengan nilai tempatnya\n4) Jumlahkan semua hasil perkalian\n\nProses dekripsi 1011010‚ÇÇ:\n\nPosisi:     6    5    4    3    2    1    0\nBiner:      1    0    1    1    0    1    0\nNilai:    2‚Å∂   2‚Åµ   2‚Å¥   2¬≥   2¬≤   2¬π   2‚Å∞\n          64   32   16    8    4    2    1\n\nPerhitungan:\n1 √ó 64 = 64\n0 √ó 32 = 0\n1 √ó 16 = 16\n1 √ó 8  = 8\n0 √ó 4  = 0\n1 √ó 2  = 2\n0 √ó 1  = 0\n         ----\nJumlah = 90‚ÇÅ‚ÇÄ\n\nRumus: 1√ó2‚Å∂ + 0√ó2‚Åµ + 1√ó2‚Å¥ + 1√ó2¬≥ + 0√ó2¬≤ + 1√ó2¬π + 0√ó2‚Å∞\n     = 64 + 0 + 16 + 8 + 0 + 2 + 0 = 90\n\nKomputer membaca biner dari kanan (LSB = Least Significant Bit) ke kiri (MSB = Most Significant Bit)"
        },
        {
          id: 4,
          icon: "üíæ",
          topic: "Konversi Biner ke Desimal",
          title: "Kode Arsip Digital",
          description: "Kamu menemukan kode arsip dalam format biner di database sekolah:",
          data: {
            message: "Kode Biner: 1101101",
            mission: "Dekripsi kode ini ke angka desimal untuk menemukan nomor arsip",
            hint: "Setiap posisi digit biner memiliki nilai tempat berupa pangkat 2"
          },
          question: "Berapakah hasil konversi bilangan biner 1101101 ke dalam sistem bilangan desimal?",
          type: "multiple_choice",
          options: [
            "107",
            "109",
            "111",
            "113"
          ],
          correctAnswer: 1,
          explanation: "Jawaban yang benar: 109‚ÇÅ‚ÇÄ\n\nProses Konversi Biner Ke Desimal:\n\nPosisi:     6    5    4    3    2    1    0\nBiner:      1    1    0    1    1    0    1\nNilai:    2‚Å∂   2‚Åµ   2‚Å¥   2¬≥   2¬≤   2¬π   2‚Å∞\n          64   32   16    8    4    2    1\n\nPerhitungan:\n1 √ó 64 = 64\n1 √ó 32 = 32\n0 √ó 16 = 0\n1 √ó 8  = 8\n1 √ó 4  = 4\n0 √ó 2  = 0\n1 √ó 1  = 1\n         ----\nJumlah = 109‚ÇÅ‚ÇÄ"
        },
        {
          id: 4,
          icon: "üíæ",
          topic: "Konversi Biner ke Desimal",
          title: "Kata Sandi Sistem",
          description: "Kamu menemukan kata sandi sistem dalam format biner di catatan lama:",
          data: {
            message: "Kode Biner: 1110011",
            mission: "Dekripsi kode ini ke angka desimal untuk akses sistem",
            hint: "Setiap posisi digit biner memiliki nilai tempat berupa pangkat 2"
          },
          question: "Berapakah hasil konversi bilangan biner 1110011 ke dalam sistem bilangan desimal?",
          type: "multiple_choice",
          options: [
            "111",
            "113",
            "115",
            "117"
          ],
          correctAnswer: 2,
          explanation: "Jawaban yang benar: 115‚ÇÅ‚ÇÄ\n\nProses Konversi Biner Ke Desimal:\n\nPosisi:     6    5    4    3    2    1    0\nBiner:      1    1    1    0    0    1    1\nNilai:    2‚Å∂   2‚Åµ   2‚Å¥   2¬≥   2¬≤   2¬π   2‚Å∞\n          64   32   16    8    4    2    1\n\nPerhitungan:\n1 √ó 64 = 64\n1 √ó 32 = 32\n1 √ó 16 = 16\n0 √ó 8  = 0\n0 √ó 4  = 0\n1 √ó 2  = 2\n1 √ó 1  = 1\n         ----\nJumlah = 115‚ÇÅ‚ÇÄ"
        }
      ],
      // Checkpoint 5: Konversi Oktal ke Desimal (3 variations)
      [
        {
          id: 5,
          icon: "üéØ",
          topic: "Konversi Oktal ke Desimal",
          title: "Kode Akses Ruang Server",
          description: "Ruang server perpustakaan menggunakan sistem bilangan oktal (basis 8) untuk keamanan:",
          data: {
            octal_code: "Kode Akses: 145‚Çà",
            mission: "Konversi ke desimal untuk mendapatkan PIN akses",
            hint: "Sistem oktal menggunakan digit 0 sampai 7, setiap posisi bernilai pangkat 8"
          },
          question: "Berapakah hasil konversi bilangan oktal 145‚Çà ke dalam sistem bilangan desimal?",
          type: "multiple_choice",
          options: [
            "99",
            "101",
            "103",
            "105"
          ],
          correctAnswer: 1,
          explanation: "Jawaban yang benar: 101‚ÇÅ‚ÇÄ\n\nProses Konversi Oktal Ke Desimal:\n\n1) Identifikasi posisi digit dari kanan ke kiri (dimulai dari 0)\n2) Hitung nilai tempat setiap posisi: 8‚Å∞, 8¬π, 8¬≤, 8¬≥, ...\n3) Kalikan setiap digit oktal dengan nilai tempatnya\n4) Jumlahkan semua hasil perkalian\n\nProses Konversi 145‚Çà:\n\nPosisi:     2      1      0\nOktal:      1      4      5\nNilai:    8¬≤     8¬π     8‚Å∞\n          64      8      1\n\nPerhitungan:\n1 √ó 8¬≤ = 1 √ó 64 = 64\n4 √ó 8¬π = 4 √ó 8  = 32\n5 √ó 8‚Å∞ = 5 √ó 1  = 5\n                  ----\nJumlah          = 101‚ÇÅ‚ÇÄ\n\nBerikut Rumus Lengkapnya:\n145‚Çà = 1√ó8¬≤ + 4√ó8¬π + 5√ó8‚Å∞\n     = 1√ó64 + 4√ó8 + 5√ó1\n     = 64 + 32 + 5\n     = 101‚ÇÅ‚ÇÄ\n\nSistem oktal efisien untuk merepresentasikan bilangan biner dalam kelompok 3 bit!\nContoh: 145‚Çà = 001 100 101‚ÇÇ = 1100101‚ÇÇ"
        },
        {
          id: 5,
          icon: "üéØ",
          topic: "Konversi Oktal ke Desimal",
          title: "Kode Keamanan Laboratorium",
          description: "Laboratorium komputer menggunakan sistem bilangan oktal (basis 8) untuk PIN keamanan:",
          data: {
            octal_code: "Kode Akses: 236‚Çà",
            mission: "Konversi ke desimal untuk mendapatkan PIN akses",
            hint: "Sistem oktal menggunakan digit 0 sampai 7, setiap posisi bernilai pangkat 8"
          },
          question: "Berapakah hasil konversi bilangan oktal 236‚Çà ke dalam sistem bilangan desimal?",
          type: "multiple_choice",
          options: [
            "156",
            "158",
            "160",
            "162"
          ],
          correctAnswer: 1,
          explanation: "Jawaban yang benar: 158‚ÇÅ‚ÇÄ\n\nProses Konversi 236‚Çà:\n\nPosisi:     2      3      6\nNilai:    8¬≤     8¬π     8‚Å∞\n          64      8      1\n\nPerhitungan:\n2 √ó 8¬≤ = 2 √ó 64 = 128\n3 √ó 8¬π = 3 √ó 8  = 24\n6 √ó 8‚Å∞ = 6 √ó 1  = 6\n                  ----\nJumlah          = 158‚ÇÅ‚ÇÄ"
        },
        {
          id: 5,
          icon: "üéØ",
          topic: "Konversi Oktal ke Desimal",
          title: "Kode Sistem Arsip",
          description: "Sistem arsip digital menggunakan sistem bilangan oktal (basis 8) untuk nomor referensi:",
          data: {
            octal_code: "Kode Arsip: 172‚Çà",
            mission: "Konversi ke desimal untuk menemukan nomor arsip",
            hint: "Sistem oktal menggunakan digit 0 sampai 7, setiap posisi bernilai pangkat 8"
          },
          question: "Berapakah hasil konversi bilangan oktal 172‚Çà ke dalam sistem bilangan desimal?",
          type: "multiple_choice",
          options: [
            "120",
            "122",
            "124",
            "126"
          ],
          correctAnswer: 1,
          explanation: "Jawaban yang benar: 122‚ÇÅ‚ÇÄ\n\nProses Konversi 172‚Çà:\n\nPosisi:     1      7      2\nNilai:    8¬≤     8¬π     8‚Å∞\n          64      8      1\n\nPerhitungan:\n1 √ó 8¬≤ = 1 √ó 64 = 64\n7 √ó 8¬π = 7 √ó 8  = 56\n2 √ó 8‚Å∞ = 2 √ó 1  = 2\n                  ----\nJumlah          = 122‚ÇÅ‚ÇÄ"
        }
      ],
      // Checkpoint 6: <i>Stack</i> (Notasi <i>Postfix</i>) (3 variations)
      [
        {
          id: 6,
          icon: "üìö",
          topic: "Struktur Data <i>Stack</i>",
          title: "Notasi <i>Postfix</i>",
          description: "Pustakawan menggunakan sistem notasi <i>postfix</i> untuk menghitung. Dalam notasi <i>postfix</i>, operator ditulis setelah <i>operand</i> (contoh: 5 3 + berarti 5 + 3).",
          data: {
            example: "Contoh: 8 2 - 3 4 + √ó berarti (8-2) √ó (3+4) = 6 √ó 7 = 42",
            postfix: "Cara kerja: Angka ditumpuk ke <i>stack</i>, operator mengambil 2 angka teratas",
            explanation: "<i>Stack</i> mengikuti prinsip LIFO (<i>Last In First Out</i>)"
          },
          question: "Berapakah hasil dari ekspresi notasi <i>postfix</i> berikut: 6 3 2 + √ó 4 -",
          type: "multiple_choice",
          options: [
            "26",
            "28",
            "30",
            "32"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: 26\n\nProses Perhitungan <i>Stack</i> (LIFO):\nEkspresi: 6 3 2 + √ó 4 -\n\nLangkah 1: <i>Push</i> 6 ‚Üí <i>Stack</i>: [6]\nLangkah 2: <i>Push</i> 3 ‚Üí <i>Stack</i>: [6, 3]\nLangkah 3: <i>Push</i> 2 ‚Üí <i>Stack</i>: [6, 3, 2]\nLangkah 4: Operator + ‚Üí <i>Pop</i> 2 dan 3\n           Hitung: 2 + 3 = 5\n           <i>Push</i> 5 ‚Üí <i>Stack</i>: [6, 5]\nLangkah 5: Operator √ó ‚Üí <i>Pop</i> 5 dan 6\n           Hitung: 5 √ó 6 = 30\n           <i>Push</i> 30 ‚Üí <i>Stack</i>: [30]\nLangkah 6: <i>Push</i> 4 ‚Üí <i>Stack</i>: [30, 4]\nLangkah 7: Operator - ‚Üí </i>Pop</i> 4 dan 30\n           Hitung: 30 - 4 = 26\n           </i>Push</i> 26 ‚Üí <i>Stack<i>: [26]\n\nHasil Akhir: 26\n\nKonversi Ke Notasi Biasa:\n6 3 2 + √ó 4 - = 6 √ó (3 + 2) - 4\n              = 6 √ó 5 - 4\n              = 30 - 4\n              = 26\n\n<i>Stack</i> mengikuti prinsip LIFO (<i>Last In First Out</i>): elemen terakhir yang masuk adalah yang pertama keluar!"
        },
        {
          id: 6,
          icon: "üìö",
          topic: "Struktur Data <i>Stack</i>",
          title: "Notasi Postfix - Perhitungan Cepat",
          description: "Sistem kalkulator menggunakan notasi <i>postfix</i> untuk perhitungan efisien. Dalam notasi <i>postfix</i>, operator ditulis setelah <i>operand</i>.",
          data: {
            example: "Contoh: 9 3 / 2 5 + √ó berarti (9/3) √ó (2+5) = 3 √ó 7 = 21",
            postfix: "Cara kerja: Angka ditumpuk ke <i>stack</i>, operator mengambil 2 angka teratas",
            explanation: "<i>Stack</i> mengikuti prinsip LIFO (<i>Last In First Out</i>)"
          },
          question: "Berapakah hasil dari ekspresi notasi <i>postfix</i> berikut: 4 8 - 2 + 3 √ó",
          type: "multiple_choice",
          options: [
            "18",
            "20",
            "22",
            "24"
          ],
          correctAnswer: 0,
          explanation: "Jawaban yang benar: 18\n\nProses Perhitungan </i>Stack</i> (LIFO):\nEkspresi: 4 8 - 2 + 3 √ó\n\nLangkah 1: <i>Push</i> 4 ‚Üí <i>Stack</i>: [4]\nLangkah 2: <i>Push</i> 8 ‚Üí <i>Stack</i>: [4, 8]\n\nLangkah 3: Operator - ‚Üí <i>Pop</i> 8 dan 4\n           Hitung: 8 - 4 = 4\n           <i>Push</i> 4 ‚Üí <i>Stack</i>: [4]\nLangkah 4: <i>Push</i> 2 ‚Üí <i>Stack</i>: [4, 2]\nLangkah 5: Operator + ‚Üí <i>Pop</i> 2 dan 4\n           Hitung: 2 + 4 = 6\n           <i>Push</i> 6 ‚Üí <i>Stack</i>: [6]\nLangkah 6: <i>Push</i> 3 ‚Üí <i>Stack</i>: [6, 3]\nLangkah 7: Operator √ó ‚Üí <i>Pop</i> 3 dan 6\n           Hitung: 3 √ó 6 = 18\n           <i>Push</i> 18 ‚Üí <i>Stack</i>: [18]\n\nHasil Akhir: 18\n\nKonversi Ke Notasi Biasa:\n8 4 - 2 + 3 √ó = (8 - 4 + 2) √ó 3\n              = 6 √ó 3\n              = 18"
        },
        {
          id: 6,
          icon: "üìö",
          topic: "Struktur Data <i>Stack</i>",
          title: "Notasi <i>Postfix</i> - Evaluasi",
          description: "Kompiler menggunakan notasi <i>postfix</i> untuk evaluasi ekspresi matematika yang efisien. Operator ditulis setelah <i>operand</i>.",
          data: {
            example: "Contoh: 10 5 - 2 3 + √ó berarti (10-5) √ó (2+3) = 5 √ó 5 = 25",
            postfix: "Cara kerja: Angka ditumpuk ke <i>stack</i>, operator mengambil 2 angka teratas",
            explanation: "<i>Stack<i> mengikuti prinsip LIFO (<i>Last In First Out</i>)"
          },
          question: "Berapakah hasil dari ekspresi notasi <i>postfix</i> berikut: 9 3 + 4 2 - √ó",
          type: "multiple_choice",
          options: [
            "22",
            "24",
            "26",
            "28"
          ],
          correctAnswer: 1,
          explanation: "Jawaban yang benar: 24\n\nProses Perhitungan <i>Stack</i> (LIFO):\nEkspresi: 9 3 + 4 2 - √ó\n\nLangkah 1: <i>Push</i> 9 ‚Üí <i>Stack</i>: [9]\nLangkah 2: <i>Push</i> 3 ‚Üí <i>Stack</i>: [9, 3]\nLangkah 3: Operator + ‚Üí <i>Pop</i> 3 dan 9\n           Hitung: 3 + 9 = 12\n           <i>Push</i> 12 ‚Üí <i>Stack</i>: [12]\nLangkah 4: <i>Push</i> 4 ‚Üí <i>Stack</i>: [12, 4]\nLangkah 5: <i>Push</i> 2 ‚Üí <i>Stack</i> [12, 4, 2]\nLangkah 6: Operator - ‚Üí <i>Pop</i> 2 dan 4\n           Hitung: 4 - 2 = 2\n           <i>Push</i> 2 ‚Üí <i>Stack</i>: [12, 2]\nLangkah 7: Operator √ó ‚Üí <i>Pop</i> 2 dan 12\n           Hitung: 2 √ó 12 = 24\n           <i>Push</i> 24 ‚Üí <i>Stack</i>: [24]\n\nHasil Akhir: 24\n\nKonversi Ke Notasi Biasa:\n9 3 + 4 2 - √ó = (9 + 3) √ó (4 - 2)\n              = 12 √ó 2\n              = 24"
        }
      ]
    ];

    // Generate unique checkpoint set for each student based on student name
    let checkpoints = [];
    let studentVariationIndex = 0;

    function generateCheckpointsForStudent(name) {
      // Generate hash from student name to get consistent variation
      let hash = 0;
      for (let i = 0; i < name.length; i++) {
        hash = ((hash << 5) - hash) + name.charCodeAt(i);
        hash = hash & hash;
      }
      studentVariationIndex = Math.abs(hash) % 3; // 0, 1, or 2

      // Select one variation from each checkpoint
      checkpoints = checkpointVariations.map(variations => variations[studentVariationIndex]);
    }

    // Start adventure
    function startAdventure() {
      const nameInput = document.getElementById("student-name-input");
      if (nameInput && nameInput.value.trim()) {
        studentName = nameInput.value.trim();
        // Generate unique checkpoints for this student
        generateCheckpointsForStudent(studentName);
        currentScreen = "maze";
        currentCheckpoint = 0;
        completedCheckpoints = [];
        renderApp();
      } else {
        showInlineMessage("Silakan masukkan nama Anda terlebih dahulu!");
      }
    }

    // Open checkpoint
    function openCheckpoint(checkpointIndex) {
      if (checkpointIndex === 0 || completedCheckpoints.includes(checkpointIndex - 1)) {
        currentCheckpoint = checkpointIndex;
        currentScreen = "question";
        currentAttempts = 0;
        userAnswer = "";
        stackItems = [];
        renderApp();
      } else {
        showInlineMessage("Selesaikan checkpoint sebelumnya terlebih dahulu!");
      }
    }

    // Show inline message (instead of alert)
    function showInlineMessage(message) {
      const messageDiv = document.createElement('div');
      messageDiv.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg z-50 slide-in';
      messageDiv.style.backgroundColor = '#fbbf24';
      messageDiv.style.color = '#000000';
      messageDiv.textContent = message;
      document.body.appendChild(messageDiv);
      
      setTimeout(() => {
        messageDiv.remove();
      }, 3000);
    }

    // Submit answer
    function submitAnswer() {
      const checkpoint = checkpoints[currentCheckpoint];
      let isCorrect = false;
      currentAttempts++;

      if (checkpoint.type === "multiple_choice") {
        const selectedOption = document.querySelector('input[name="answer"]:checked');
        if (!selectedOption) {
          showInlineMessage("Silakan pilih salah satu jawaban!");
          return;
        }
        userAnswer = checkpoint.options[parseInt(selectedOption.value)];
        isCorrect = parseInt(selectedOption.value) === checkpoint.correctAnswer;
      }

      // Save to localStorage instead of Data SDK
      const answerData = {
        student_name: studentName,
        checkpoint_number: checkpoint.id,
        question_topic: checkpoint.topic,
        answer: userAnswer,
        is_correct: isCorrect,
        attempts: currentAttempts,
        timestamp: new Date().toISOString()
      };
      
      // Get existing data
      let savedAnswers = JSON.parse(localStorage.getItem('studentAnswers') || '[]');
      savedAnswers.push(answerData);
      localStorage.setItem('studentAnswers', JSON.stringify(savedAnswers));

      currentScreen = "feedback";
      if (isCorrect && !completedCheckpoints.includes(currentCheckpoint)) {
        completedCheckpoints.push(currentCheckpoint);
      }
      renderApp();
    }

    // Continue from feedback
    function continueMaze() {
      if (completedCheckpoints.length === checkpoints.length) {
        currentScreen = "victory";
      } else {
        currentScreen = "maze";
      }
      renderApp();
    }

    // Restart adventure
    function restartAdventure() {
      currentScreen = "welcome";
      currentCheckpoint = 0;
      completedCheckpoints = [];
      studentName = "";
      renderApp();
    }

    // Show keyboard when input is focused
    let keyboardVisible = false;

    function showKeyboard() {
      keyboardVisible = true;
      const keyboard = document.getElementById("virtual-keyboard");
      if (keyboard) {
        keyboard.style.display = "block";
      }
    }

    function hideKeyboard() {
      keyboardVisible = false;
      const keyboard = document.getElementById("virtual-keyboard");
      if (keyboard) {
        keyboard.style.display = "none";
      }
    }

    // Virtual Keyboard Functions
    function typeKey(key) {
      const input = document.getElementById("student-name-input");
      if (input) {
        input.value += key;
        input.focus();
      }
    }

    function backspaceKey() {
      const input = document.getElementById("student-name-input");
      if (input) {
        input.value = input.value.slice(0, -1);
        input.focus();
      }
    }

    function spaceKey() {
      const input = document.getElementById("student-name-input");
      if (input) {
        input.value += " ";
        input.focus();
      }
    }

    function clearKey() {
      const input = document.getElementById("student-name-input");
      if (input) {
        input.value = "";
        input.focus();
      }
    }

    // Render application
    function renderApp() {
      const config = defaultConfig;
      const app = document.getElementById("app");
      const customFont = config.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size;

      app.style.fontFamily = `${customFont}, ${baseFontStack}`;
      app.style.backgroundColor = config.background_color;

      if (currentScreen === "welcome") {
        app.innerHTML = `
          <div class="w-full h-full flex items-center justify-center p-8">
            <div class="slide-in max-w-3xl w-full p-8 rounded-2xl shadow-2xl" style="background-color: ${config.secondary_color};">
              <div class="text-center mb-6">
                <div class="text-6xl mb-4 bounce-animation">üéì</div>
                <h1 class="font-bold mb-2" style="color: ${config.text_color}; font-size: ${baseSize * 2.5}px;">${config.quiz_title}</h1>
                <p class="mb-4" style="color: ${config.text_color}; font-size: ${baseSize * 1.2}px;">${config.maze_theme}</p>
              </div>
              
              <div class="mb-6 p-6 rounded-xl" style="background: linear-gradient(135deg, ${config.primary_color}20, ${config.accent_color}20);">
                <h2 class="font-bold mb-3" style="color: ${config.text_color}; font-size: ${baseSize * 1.3}px;">üéØ Petunjuk Petualangan:</h2>
                <ul class="space-y-2" style="color: ${config.text_color}; font-size: ${baseSize}px;">
                  <li>‚úÖ Selesaikan 6 soal secara berurutan</li>
                  <li>üîí Checkpoint berikutnya terbuka setelah menjawab soal dengan benar</li>
                  <li>üí° Bacalah penjelasan untuk mengetahui konsep lebih mendalam</li>
                  <li>üèÜ Jawablah semua soal dengan jujur dan benar!</li>
                </ul>
              </div>
              
              <div class="mb-6">
                <label for="student-name-input" class="block mb-2 font-semibold" style="color: ${config.text_color}; font-size: ${baseSize * 1.1}px;">Nama Petualang:</label>
                <input 
                  type="text" 
                  id="student-name-input" 
                  placeholder="Ketuk di sini untuk mengetik" 
                  class="w-full p-4 rounded-lg border-2 focus:outline-none focus:ring-2"
                  style="font-size: ${baseSize}px; border-color: ${config.primary_color};"
                  onfocus="showKeyboard()"
                  readonly
                >
                
                <!-- Virtual Keyboard (hidden by default) -->
                <div id="virtual-keyboard" class="mt-4 p-3 rounded-lg" style="background-color: ${config.background_color}; display: none;">
                  <p class="text-center mb-2 text-xs" style="color: ${config.text_color}; opacity: 0.7;">‚å®Ô∏è Keyboard Virtual</p>
                  <div class="virtual-keyboard">
                    <!-- Row 1 -->
                    <div class="keyboard-row">
                      ${['Q','W','E','R','T','Y','U','I','O','P'].map(key => `
                        <button onclick="typeKey('${key}')" class="key-button" style="background-color: ${config.secondary_color}; color: ${config.text_color}; font-size: ${baseSize * 0.75}px;">${key}</button>
                      `).join('')}
                    </div>
                    <!-- Row 2 -->
                    <div class="keyboard-row">
                      ${['A','S','D','F','G','H','J','K','L'].map(key => `
                        <button onclick="typeKey('${key}')" class="key-button" style="background-color: ${config.secondary_color}; color: ${config.text_color}; font-size: ${baseSize * 0.75}px;">${key}</button>
                      `).join('')}
                    </div>
                    <!-- Row 3 -->
                    <div class="keyboard-row">
                      ${['Z','X','C','V','B','N','M'].map(key => `
                        <button onclick="typeKey('${key}')" class="key-button" style="background-color: ${config.secondary_color}; color: ${config.text_color}; font-size: ${baseSize * 0.75}px;">${key}</button>
                      `).join('')}
                      <button onclick="backspaceKey()" class="key-button key-special" style="background-color: #ef4444; color: white; font-size: ${baseSize * 0.65}px;">‚Üê</button>
                    </div>
                    <!-- Row 4 -->
                    <div class="keyboard-row">
                      <button onclick="clearKey()" class="key-button key-special" style="background-color: #f59e0b; color: white; font-size: ${baseSize * 0.65}px;">Clear</button>
                      <button onclick="spaceKey()" class="key-button key-space" style="background-color: ${config.secondary_color}; color: ${config.text_color}; font-size: ${baseSize * 0.65}px;">SPASI</button>
                      <button onclick="hideKeyboard()" class="key-button key-special" style="background-color: ${config.primary_color}; color: white; font-size: ${baseSize * 0.65}px;">Tutup</button>
                    </div>
                  </div>
                </div>
              </div>
              
              <button 
                onclick="startAdventure()" 
                class="w-full py-4 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all"
                style="background-color: ${config.primary_color}; font-size: ${baseSize * 1.3}px;"
              >
                üöÄ Mulai Petualangan
              </button>
            </div>
          </div>
        `;
      } else if (currentScreen === "maze") {
        const progress = (completedCheckpoints.length / checkpoints.length) * 100;
        
        app.innerHTML = `
          <div class="w-full h-full overflow-auto p-8">
            <div class="max-w-6xl mx-auto">
              <div class="mb-6 p-4 rounded-xl shadow-lg" style="background-color: ${config.secondary_color};">
                <div class="flex justify-between items-center mb-3">
                  <div>
                    <h2 class="font-bold" style="color: ${config.text_color}; font-size: ${baseSize * 1.5}px;">üß≠ ${config.maze_theme}</h2>
                    <p style="color: ${config.text_color}; font-size: ${baseSize}px;">Petualang: <span class="font-semibold">${studentName}</span></p>
                  </div>
                  <div class="text-right">
                    <p class="font-bold" style="color: ${config.primary_color}; font-size: ${baseSize * 1.8}px;">${completedCheckpoints.length}/${checkpoints.length}</p>
                    <p style="color: ${config.text_color}; font-size: ${baseSize * 0.9}px;">Checkpoint Selesai</p>
                  </div>
                </div>
                <div class="w-full h-4 rounded-full overflow-hidden" style="background-color: ${config.background_color};">
                  <div class="h-full transition-all duration-500" style="width: ${progress}%; background: linear-gradient(90deg, ${config.primary_color}, ${config.accent_color});"></div>
                </div>
              </div>
              
              <div class="slide-in p-8 rounded-2xl shadow-2xl relative" style="background-color: ${config.secondary_color}; min-height: 500px;">
                <h3 class="font-bold text-center mb-8" style="color: ${config.text_color}; font-size: ${baseSize * 1.5}px;">Peta Perjalanan</h3>
                
                <svg width="100%" height="400" class="mb-4">
                  <!-- Path line -->
                  <path d="M 100 50 L 300 50 L 300 150 L 500 150 L 500 250 L 300 250 L 300 350 L 500 350" 
                        stroke="${config.primary_color}" 
                        stroke-width="4" 
                        fill="none" 
                        class="maze-path" />
                  
                  <!-- Checkpoints -->
                  ${checkpoints.map((cp, index) => {
                    const positions = [
                      { x: 100, y: 50 },
                      { x: 300, y: 50 },
                      { x: 500, y: 150 },
                      { x: 500, y: 250 },
                      { x: 300, y: 350 },
                      { x: 500, y: 350 }
                    ];
                    const pos = positions[index];
                    const isCompleted = completedCheckpoints.includes(index);
                    const isActive = !isCompleted && (index === 0 || completedCheckpoints.includes(index - 1));
                    const isLocked = !isActive && !isCompleted;
                    
                    return `
                      <g transform="translate(${pos.x}, ${pos.y})">
                        <circle cx="0" cy="0" r="35" 
                                fill="${isCompleted ? config.accent_color : isActive ? config.primary_color : '#cbd5e1'}" 
                                stroke="${config.text_color}" 
                                stroke-width="3"
                                class="${isActive && !isCompleted ? 'checkpoint-active' : ''}"
                                style="cursor: ${isActive || isCompleted ? 'pointer' : 'not-allowed'};"
                                onclick="${isActive || isCompleted ? `openCheckpoint(${index})` : ''}" />
                        <text x="0" y="10" text-anchor="middle" font-size="28">${cp.icon}</text>
                        <text x="0" y="60" text-anchor="middle" font-size="14" fill="${config.text_color}" font-weight="bold">${cp.topic}</text>
                        ${isCompleted ? `<text x="0" y="-50" text-anchor="middle" font-size="24">‚úì</text>` : ''}
                        ${isLocked ? `<text x="0" y="-50" text-anchor="middle" font-size="24">üîí</text>` : ''}
                      </g>
                    `;
                  }).join('')}
                </svg>
                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-8">
                  ${checkpoints.map((cp, index) => {
                    const isCompleted = completedCheckpoints.includes(index);
                    const isActive = !isCompleted && (index === 0 || completedCheckpoints.includes(index - 1));
                    const isLocked = !isActive && !isCompleted;
                    
                    return `
                      <button 
                        onclick="${isActive || isCompleted ? `openCheckpoint(${index})` : ''}"
                        class="p-4 rounded-lg shadow-md transition-all ${isActive || isCompleted ? 'hover:shadow-lg' : 'opacity-50 cursor-not-allowed'}"
                        style="background-color: ${isCompleted ? config.accent_color : isActive ? config.primary_color : '#cbd5e1'}20; border: 2px solid ${isCompleted ? config.accent_color : isActive ? config.primary_color : '#cbd5e1'};"
                      >
                        <div class="text-3xl mb-2">${cp.icon} ${isCompleted ? '‚úì' : isLocked ? 'üîí' : ''}</div>
                        <p class="font-semibold" style="color: ${config.text_color}; font-size: ${baseSize * 0.9}px;">${cp.topic}</p>
                        <p style="color: ${config.text_color}; font-size: ${baseSize * 0.75}px;">${isCompleted ? 'Selesai' : isActive ? 'Klik untuk mulai' : 'Terkunci'}</p>
                      </button>
                    `;
                  }).join('')}
                </div>
              </div>
            </div>
          </div>
        `;
      } else if (currentScreen === "question") {
        const checkpoint = checkpoints[currentCheckpoint];
        
        let questionInterface = "";
        
        if (checkpoint.type === "multiple_choice") {
          questionInterface = `
            <div class="space-y-3 mb-6">
              ${checkpoint.options.map((option, index) => `
                <label class="flex items-start p-4 rounded-lg border-2 cursor-pointer transition-all hover:shadow-md" style="background-color: ${config.secondary_color}; border-color: #d1d5db;">
                  <input type="radio" name="answer" value="${index}" class="mt-1 mr-3" style="width: 20px; height: 20px;">
                  <span style="color: ${config.text_color}; font-size: ${baseSize}px;">${option}</span>
                </label>
              `).join('')}
            </div>
          `;
        }
        
        app.innerHTML = `
          <div class="w-full h-full overflow-auto p-8">
            <div class="max-w-5xl mx-auto">
              <div class="mb-4">
                <button 
                  onclick="currentScreen = 'maze'; renderApp();"
                  class="px-4 py-2 rounded-lg font-semibold"
                  style="background-color: ${config.background_color}; color: ${config.text_color}; font-size: ${baseSize * 0.9}px;"
                >
                  ‚Üê Kembali ke Peta
                </button>
              </div>
              
              <div class="slide-in p-8 rounded-2xl shadow-2xl" style="background-color: ${config.secondary_color};">
                <div class="flex items-center gap-4 mb-6">
                  <div class="text-5xl">${checkpoint.icon}</div>
                  <div>
                    <span class="inline-block px-3 py-1 rounded-full text-white font-semibold mb-2" 
                          style="background-color: ${config.primary_color}; font-size: ${baseSize * 0.85}px;">
                      Checkpoint ${checkpoint.id}
                    </span>
                    <h2 class="font-bold" style="color: ${config.text_color}; font-size: ${baseSize * 1.8}px;">${checkpoint.title}</h2>
                  </div>
                </div>
                
                <div class="mb-6 p-5 rounded-lg" style="background-color: ${config.background_color};">
                  <p class="mb-3" style="color: ${config.text_color}; font-size: ${baseSize * 1.1}px;">${checkpoint.description}</p>
                  
                  ${checkpoint.data.table ? `
                    <div class="overflow-x-auto">
                      <table class="w-full mt-3" style="border-collapse: collapse;">
                        <thead>
                          <tr style="background-color: ${config.primary_color}; color: white;">
                            <th class="p-3 text-left" style="font-size: ${baseSize}px;">Minggu</th>
                            <th class="p-3 text-left" style="font-size: ${baseSize}px;">Tinggi (cm)</th>
                          </tr>
                        </thead>
                        <tbody>
                          ${checkpoint.data.table.map(row => `
                            <tr style="border-bottom: 1px solid #d1d5db;">
                              <td class="p-3" style="color: ${config.text_color}; font-size: ${baseSize}px;">${row.week}</td>
                              <td class="p-3 font-bold" style="color: ${config.text_color}; font-size: ${baseSize}px;">${row.height}</td>
                            </tr>
                          `).join('')}
                        </tbody>
                      </table>
                    </div>
                  ` : ''}
                  
                  ${checkpoint.data.effects ? `
                    <div class="space-y-2 mt-3">
                      ${checkpoint.data.effects.map(effect => `
                        <p style="color: ${config.text_color}; font-size: ${baseSize}px;">${effect}</p>
                      `).join('')}
                      <p class="mt-3 font-semibold" style="color: ${config.text_color}; font-size: ${baseSize}px;">üåº ${checkpoint.data.initial}</p>
                      <div class="mt-4 p-3 rounded" style="background-color: ${config.secondary_color};">
                        <p class="font-bold mb-2" style="color: ${config.text_color}; font-size: ${baseSize}px;">Hasil Percobaan:</p>
                        ${checkpoint.data.experiments.map((exp, i) => `
                          <p style="color: ${config.text_color}; font-size: ${baseSize * 0.9}px;">Percobaan ${i+1}: ${exp.mix} ‚Üí ${exp.result}</p>
                        `).join('')}
                      </div>
                    </div>
                  ` : ''}
                  
                  ${checkpoint.data.clue ? `
                    <div class="space-y-2 mt-3">
                      <p class="font-bold" style="color: ${config.text_color}; font-size: ${baseSize * 1.1}px;">${checkpoint.data.clue}</p>
                      <p style="color: ${config.text_color}; font-size: ${baseSize}px;">${checkpoint.data.hint}</p>
                      <p class="text-sm italic" style="color: ${config.text_color}; font-size: ${baseSize * 0.85}px;">${checkpoint.data.process}</p>
                    </div>
                  ` : ''}
                  
                  ${checkpoint.data.message ? `
                    <div class="space-y-2 mt-3">
                      <p class="font-bold font-mono" style="color: ${config.primary_color}; font-size: ${baseSize * 1.2}px;">${checkpoint.data.message}</p>
                      <p style="color: ${config.text_color}; font-size: ${baseSize}px;">${checkpoint.data.mission}</p>
                      <p class="text-sm italic" style="color: ${config.text_color}; font-size: ${baseSize * 0.85}px;">${checkpoint.data.hint}</p>
                    </div>
                  ` : ''}
                  
                  ${checkpoint.data.octal_code ? `
                    <div class="space-y-2 mt-3">
                      <p class="font-bold font-mono" style="color: ${config.primary_color}; font-size: ${baseSize * 1.2}px;">${checkpoint.data.octal_code}</p>
                      <p style="color: ${config.text_color}; font-size: ${baseSize}px;">${checkpoint.data.mission}</p>
                      <p class="text-sm italic" style="color: ${config.text_color}; font-size: ${baseSize * 0.85}px;">${checkpoint.data.hint}</p>
                    </div>
                  ` : ''}
                  
                  ${checkpoint.data.example ? `
                    <div class="space-y-2 mt-3 p-3 rounded" style="background-color: ${config.secondary_color};">
                      <p style="color: ${config.text_color}; font-size: ${baseSize}px;">${checkpoint.data.example}</p>
                      <p class="font-mono font-bold" style="color: ${config.primary_color}; font-size: ${baseSize * 1.1}px;">${checkpoint.data.postfix}</p>
                      <p class="text-sm" style="color: ${config.text_color}; font-size: ${baseSize * 0.85}px;">${checkpoint.data.explanation}</p>
                    </div>
                  ` : ''}
                </div>
                
                <div class="mb-6 p-4 rounded-lg" style="background: linear-gradient(135deg, ${config.primary_color}15, ${config.accent_color}15);">
                  <h3 class="font-bold mb-2" style="color: ${config.text_color}; font-size: ${baseSize * 1.2}px;"> Pertanyaan:</h3>
                  <p style="color: ${config.text_color}; font-size: ${baseSize * 1.1}px; white-space: pre-line;">${checkpoint.question}</p>
                </div>
                
                ${questionInterface}
                
                <button 
                  onclick="submitAnswer()" 
                  class="w-full py-4 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all"
                  style="background-color: ${config.accent_color}; font-size: ${baseSize * 1.2}px;"
                >
                  ‚úì Kirim Jawaban
                </button>
              </div>
            </div>
          </div>
        `;
      } else if (currentScreen === "feedback") {
        const checkpoint = checkpoints[currentCheckpoint];
        const isCorrect = completedCheckpoints.includes(currentCheckpoint);
        
        app.innerHTML = `
          <div class="w-full h-full overflow-auto p-8">
            <div class="max-w-4xl mx-auto">
              <div class="slide-in p-8 rounded-2xl shadow-2xl ${isCorrect ? 'feedback-correct' : 'feedback-incorrect'}" style="background-color: ${config.secondary_color};">
                <div class="text-center mb-6">
                  <div class="text-7xl mb-4 ${isCorrect ? 'bounce-animation' : 'shake-animation'}">${isCorrect ? 'üéâ' : 'ü§î'}</div>
                  <h2 class="font-bold mb-3" style="color: ${config.text_color}; font-size: ${baseSize * 2}px;">
                    ${isCorrect ? 'Jawaban Benar!' : 'Belum Tepat'}
                  </h2>
                  <p style="color: ${config.text_color}; font-size: ${baseSize * 1.2}px;">
                    ${isCorrect ? 'Checkpoint berhasil diselesaikan!' : 'Coba pahami penjelasan di bawah dan coba lagi!'}
                  </p>
                </div>
                
                <div class="mb-6 p-6 rounded-lg" style="background-color: ${config.background_color};">
                  <h3 class="font-bold mb-3 flex items-center gap-2" style="color: ${config.text_color}; font-size: ${baseSize * 1.3}px;">
                    üí° Penjelasan Lengkap:
                  </h3>
                  <p style="color: ${config.text_color}; font-size: ${baseSize}px; line-height: 1.8; white-space: pre-line;">${checkpoint.explanation}</p>
                </div>
                
                ${!isCorrect ? `
                  <div class="mb-6 p-4 rounded-lg" style="background-color: ${config.primary_color}20; border-left: 4px solid ${config.primary_color};">
                    <p style="color: ${config.text_color}; font-size: ${baseSize}px;">
                      <strong>Percobaan ke-${currentAttempts}:</strong> Pelajari penjelasan di atas, lalu coba jawab lagi dengan pendekatan yang berbeda!
                    </p>
                  </div>
                ` : ''}
                
                <div class="flex gap-4">
                  ${!isCorrect ? `
                    <button 
                      onclick="currentScreen = 'question'; renderApp();" 
                      class="flex-1 py-4 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all"
                      style="background-color: ${config.primary_color}; font-size: ${baseSize * 1.1}px;"
                    >
                      üîÑ Coba Lagi
                    </button>
                  ` : ''}
                  <button 
                    onclick="continueMaze()" 
                    class="flex-1 py-4 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all"
                    style="background-color: ${config.accent_color}; font-size: ${baseSize * 1.1}px;"
                  >
                    ${isCorrect ? '‚Üí Lanjutkan Petualangan' : '‚Üê Kembali ke Peta'}
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      } else if (currentScreen === "victory") {
        app.innerHTML = `
          <div class="w-full h-full flex items-center justify-center p-8">
            <div class="slide-in max-w-3xl w-full p-8 rounded-2xl shadow-2xl text-center" style="background-color: ${config.secondary_color};">
              <div class="text-8xl mb-6 bounce-animation">üèÜ</div>
              <h1 class="font-bold mb-4" style="color: ${config.text_color}; font-size: ${baseSize * 2.5}px;">Selamat, ${studentName}!</h1>
              <p class="mb-6" style="color: ${config.text_color}; font-size: ${baseSize * 1.3}px;">Kamu telah menyelesaikan semua checkpoint!</p>
              
              <div class="grid grid-cols-2 gap-6 mb-8 p-6 rounded-xl" style="background: linear-gradient(135deg, ${config.primary_color}20, ${config.accent_color}20);">
                <div>
                  <div class="text-5xl mb-2">‚úÖ</div>
                  <p class="font-bold" style="color: ${config.primary_color}; font-size: ${baseSize * 2}px;">6/6</p>
                  <p style="color: ${config.text_color}; font-size: ${baseSize}px;">Checkpoint Selesai</p>
                </div>
                <div>
                  <div class="text-5xl mb-2">üß†</div>
                  <p class="font-bold" style="color: ${config.primary_color}; font-size: ${baseSize * 2}px;">100%</p>
                  <p style="color: ${config.text_color}; font-size: ${baseSize}px;">Penguasaan Materi</p>
                </div>
              </div>
              
              <div class="mb-6 p-6 rounded-xl text-left" style="background-color: ${config.background_color};">
                <h3 class="font-bold mb-3" style="color: ${config.text_color}; font-size: ${baseSize * 1.2}px;">üìö Materi yang Telah Dikuasai:</h3>
                <div class="space-y-2">
                  ${checkpoints.map(cp => `
                    <p style="color: ${config.text_color}; font-size: ${baseSize}px;">‚úì ${cp.icon} ${cp.topic}</p>
                  `).join('')}
                </div>
              </div>
              
              <div class="p-5 rounded-lg mb-6" style="background: linear-gradient(135deg, ${config.primary_color}, ${config.accent_color}); color: white;">
                <p class="font-bold" style="font-size: ${baseSize * 1.3}px;">üéì Kamu telah menguasai Berpikir Komputasional tingkat lanjut!</p>
                <p style="font-size: ${baseSize}px;">Terus asah kemampuanmu dalam memecahkan masalah kompleks!</p>
              </div>
              
              <button 
                onclick="restartAdventure()" 
                class="w-full py-4 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all"
                style="background-color: ${config.primary_color}; font-size: ${baseSize * 1.2}px;"
              >
                üîÑ Mulai Petualangan Baru
              </button>
            </div>
          </div>
        `;
      }
    }

    // Initialize app when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      renderApp();
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b982387748cfd7c',t:'MTc2NzY3MDI0OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
